<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/dashboard"></ion-back-button>
    </ion-buttons>
    <ion-title>Nearby Vets</ion-title>
  </ion-toolbar>
  <ion-toolbar>
    <ion-searchbar placeholder="Filter by name or specialty"></ion-searchbar>
  </ion-toolbar>
</ion-header>

<ion-content>
  <capacitor-google-map #map></capacitor-google-map>

  <div class="loading-container" *ngIf="isLoading">
    <ion-spinner name="crescent"></ion-spinner>
    <p>Finding you and nearby vets...</p>
  </div>

  <ion-modal
    [isOpen]="true"
    [initialBreakpoint]="listSheetBreakpoint"
    [breakpoints]="[0.1, 0.25, 0.4, 0.7, 1]"
    handleBehavior="cycle"
    class="list-modal"
  >
    <ng-template>
      <ion-header>
        <ion-toolbar>
          <ion-title>Vets Near Me</ion-title>
        </ion-toolbar>
      </ion-header>
      <ion-content>
        <ion-list *ngIf="!isLoading">
          <ion-item *ngIf="nearbyVets.length === 0">
            <ion-label>No vets found nearby.</ion-label>
          </ion-item>

          <ion-item *ngFor="let vet of nearbyVets" lines="full" class="vet-item">
            <ion-label>
              <h2>{{ vet.name }}</h2>
              <p>{{ vet.address }}</p>
              <p>
                <ion-icon name="star" color="warning" *ngIf="vet.rating"></ion-icon>
                {{ vet.rating || 'No rating' }} ({{ vet.userRatingsTotal || 0 }} reviews)
              </p>
            </ion-label>

            <ion-buttons slot="end">
              <ion-button (click)="openDirections(vet)" fill="clear" color="primary" title="Directions">
                <ion-icon slot="icon-only" name="navigate-outline"></ion-icon>
              </ion-button>
              <ion-button (click)="callVet(vet)" fill="clear" color="success" title="Call">
                <ion-icon slot="icon-only" name="call-outline"></ion-icon>
              </ion-button>
              <ion-button (click)="bookVet(vet)" fill="clear" color="secondary" title="Book">
                <ion-icon slot="icon-only" name="calendar-outline"></ion-icon>
              </ion-button>
            </ion-buttons>
            
          </ion-item>
        </ion-list>
      </ion-content>
    </ng-template>
  </ion-modal>

</ion-content>